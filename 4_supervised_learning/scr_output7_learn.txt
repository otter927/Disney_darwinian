[[[0.47770039 0.39724611 0.65283742 ... 0.33736391 0.19783403 0.26569349]
  [0.48890336 0.96063482 0.60517954 ... 0.17146474 0.64504151 0.34172371]
  [0.67816515 0.33599256 0.50435231 ... 0.22967327 0.06552861 0.7761166 ]
  ...
  [0.75904878 0.83887903 0.66919471 ... 0.27345884 0.36570311 0.19662699]
  [0.8153148  0.27565145 0.21483522 ... 0.31651252 0.15227773 0.61460433]
  [0.43758957 0.35704552 0.69891352 ... 0.71874802 0.32353841 0.4993295 ]]

 [[0.82075274 0.00371367 0.1390476  ... 0.94468715 0.46518912 0.14793747]
  [0.29214262 0.08002481 0.89869218 ... 0.2075615  0.33552709 0.05937008]
  [0.02329637 0.57928213 0.38538198 ... 0.31549947 0.53149824 0.0453673 ]
  ...
  [0.96370547 0.71979696 0.1170033  ... 0.97114748 0.7602016  0.14486154]
  [0.96067018 0.27653839 0.56560284 ... 0.40798438 0.53257706 0.6766    ]
  [0.89052605 0.51118289 0.5686774  ... 0.46709326 0.53712187 0.55274791]]

 [[0.1317211  0.1508103  0.35463305 ... 0.6341448  0.98209124 0.57975548]
  [0.15069582 0.52532898 0.57843678 ... 0.9517332  0.11991485 0.95468499]
  [0.81631903 0.34686312 0.73130566 ... 0.54038967 0.7764459  0.76220946]
  ...
  [0.24557716 0.2289947  0.19796092 ... 0.05827126 0.11533761 0.49136727]
  [0.6846112  0.71094486 0.97452279 ... 0.24174398 0.71517874 0.68138765]
  [0.53401994 0.88574956 0.5570083  ... 0.08116018 0.09499592 0.60621475]]

 [[0.82862853 0.09147724 0.56413294 ... 0.20975306 0.25068853 0.83180771]
  [0.8723088  0.57718744 0.1137546  ... 0.89841092 0.79182966 0.38790607]
  [0.16072247 0.86274017 0.18649238 ... 0.11776397 0.90280034 0.7137821 ]
  ...
  [0.78815503 0.83518951 0.00430462 ... 0.158436   0.75663966 0.70451722]
  [0.09903081 0.04031066 0.81993304 ... 0.51043017 0.32177538 0.70130073]
  [0.41299132 0.67510536 0.54356898 ... 0.80219615 0.67126211 0.32557681]]]
[[ 1  1  1  1  1 -1 -1  1 -1 -1  1  1 -1 -1  1  1]
 [ 1  1 -1  1 -1 -1 -1  1  1  1  1  1 -1 -1  1  1]
 [-1 -1  1  1  1  1 -1 -1  1 -1 -1 -1  1  1 -1 -1]
 [-1 -1  1 -1  1  1  1  1 -1  1 -1 -1 -1  1  1 -1]]
train_ds
<BatchDataset element_spec=(TensorSpec(shape=(None, 40, 16), dtype=tf.float64, name=None), TensorSpec(shape=(None, 16), dtype=tf.int64, name=None))>
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 simple_rnn (SimpleRNN)      (None, 16)                528       
                                                                 
=================================================================
Total params: 528
Trainable params: 528
Non-trainable params: 0
_________________________________________________________________
x_mb
tf.Tensor(
[[ 1  1 -1  1 -1 -1 -1  1  1  1  1  1 -1 -1  1  1]
 [-1 -1  1 -1  1  1  1  1 -1  1 -1 -1 -1  1  1 -1]], shape=(2, 16), dtype=int64)
tr_loss:[1.2332125 1.6201975]
x_mb
tf.Tensor(
[[ 1  1  1  1  1 -1 -1  1 -1 -1  1  1 -1 -1  1  1]
 [ 1  1 -1  1 -1 -1 -1  1  1  1  1  1 -1 -1  1  1]], shape=(2, 16), dtype=int64)
tr_loss:[1.0216622 1.0466521]
1/1 [==============================] - ETA: 0s1/1 [==============================] - 1s 631ms/step
[[ 0.27777028  0.3206716  -0.12788968  0.40414375  0.25235277 -0.09363662
   0.7273373   0.17688565 -0.02692376  0.01061426  0.81569904 -0.14896381
  -0.7783927  -0.58428377  0.18819584 -0.35160434]
 [-0.018211    0.46735203 -0.12982675 -0.42967728  0.16576622  0.38108522
   0.92844856  0.5633853   0.2667779   0.45234525  0.93340147  0.6113778
  -0.50583804 -0.5177788   0.57608896 -0.29049823]
 [-0.5943126   0.01861393 -0.7886372   0.23934488  0.08183759  0.1407893
   0.88751876  0.06829697  0.93478453 -0.37997574  0.9174161  -0.19168991
  -0.21419844 -0.55984396  0.6511253   0.21968141]
 [-0.42303532 -0.2803946  -0.8626571  -0.28045952  0.2195435  -0.12450788
   0.94794184  0.15022165  0.9754925  -0.91313106  0.8698617   0.5908676
  -0.3038872   0.3078567   0.7933227   0.08005086]]
